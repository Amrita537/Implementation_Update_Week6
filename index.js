function showLayerNames() {
    const app = window.require("photoshop").app;
    const allLayers = app.activeDocument.layers;
    const allLayerNames = allLayers.map(layer => layer.name);
    const sortedNames = allLayerNames.sort((a, b) => a < b ? -1 : a > b ? 1 : 0);
    document.getElementById("layers").innerHTML = `
      <ul>${
        sortedNames.map(name => `<li>${name}</li>`).join("")
      }</ul>`;
}

const app = window.require("photoshop").app;
const run=require('photoshop').core.executeAsModal;
const batchPlay = require("photoshop").action.batchPlay;


function PenTool()
{

  run(()=>{ const result = batchPlay(
[
   {
      _obj: "select",
      _target: [
         {
            _ref: "penTool"
         }
      ],
      _options: {
         dialogOptions: "dontDisplay"
      }
   }
],{
   synchronousExecution: false,
   modalBehavior: "fail"
});


  })

}


function LasoTool()
{

  run(()=>{


    const result = batchPlay(
[
   {
      _obj: "set",
      _target: [
         {
            _ref: "channel",
            _property: "selection"
         }
      ],
      to: {
         _obj: "polygon",
         points: {
            _objList: "paint",
            horizontal: {
               list: [
                  293.7183908045977,
                  293.7183908045977,
                  294.4676724137931,
                  294.6784078663793,
                  294.7872512641994,
                  295.00210264359396,
                  295.1095283332912,
                  295.1632640443999,
                  295.1901090336942,
                  295.20350866208133,
                  295.2102313425349,
                  295.21356981650166,
                  295.2152619197451,
                  295.21613083762685,
                  295.2165424303077,
                  295.2167710929081,
                  295.21686255794833,
                  295.21690829046844,
                  295.21690829046844,
                  295.2169540229885,
                  295.2169540229885,
                  295.2169540229885,
                  295.2169540229885,
                  295.2169540229885,
                  295.2169540229885,
                  295.2169540229885,
                  295.2169540229885,
                  295.2169540229885,
                  295.2169540229885,
                  295.2169540229885,
                  295.2169540229885,
                  295.2169540229885,
                  295.2169540229885,
                  295.2169540229885,
                  295.2169540229885,
                  295.65058977850555,
                  297.3448881828922,
                  301.5258923673082,
                  305.0902849833171,
                  310.64353916562834,
                  316.4173155598257,
                  321.5520257182505,
                  325.91582278547617,
                  330.16538001751076,
                  335.8707405616497,
                  341.7684978178178,
                  349.2132490311546,
                  355.18349233166924,
                  361.16571755244814,
                  366.0667802657204,
                  369.2731329819252,
                  374.7736118360497,
                  376.8477188198046,
                  383.23705493444686,
                  387.80948375833447,
                  394.71221314353505,
                  401.16072713917697,
                  407.38208770751953,
                  414.9884576468632,
                  420.2901829686658,
                  426.6874765418042,
                  431.3847094130242,
                  435.23186620076496,
                  439.4032665559615,
                  440.67376169665107,
                  444.37210486401085,
                  447.7198167998215,
                  450.89223598611767,
                  453.9770316639166,
                  457.0179698549468,
                  460.78628377804813,
                  463.4196994825341,
                  466.234993419428,
                  468.3919219970703,
                  470.9689495042823,
                  472.2574632578883,
                  472.90169726843123,
                  473.2238371399627,
                  472.6356254665331,
                  470.84295641142745,
                  469.1973631409393,
                  466.87598042104435,
                  463.46744423351066,
                  460.26461292135303,
                  457.1646340468834,
                  454.11605852499775,
                  451.09323041192414,
                  447.33397152780117,
                  443.20647439189344,
                  438.8949038626134,
                  434.4912737703871,
                  428.54307354455705,
                  420.32397930101416,
                  413.21728287620107,
                  407.41611270246835,
                  402.2676827880158,
                  400.2329057715405,
                  396.3232783613534,
                  392.130703849354,
                  387.17773472577676,
                  383.65985208270195,
                  377.6517422555507,
                  371.6505837714535,
                  368.14445438604247,
                  363.8964063271709,
                  360.66878798912313,
                  357.62391680136494,
                  354.62258297273485,
                  351.6303499156031,
                  348.63857418367235,
                  346.7826570532788,
                  345.0973679553503,
                  342.7647807680327,
                  340.8521095802044,
                  339.13823765721816,
                  336.78850077486584,
                  333.7009154133413,
                  331.67958375777323,
                  329.6168641715214,
                  328.2410470370589,
                  324.82725160971455,
                  322.89354346264366,
                  320.41964278824025,
                  317.2493730303885,
                  314.14573555431144,
                  312.9742970521423,
                  311.6666671051376,
                  310.27681008700665,
                  307.88403890324736,
                  306.81943156801424,
                  305.63139216105145,
                  304.84424402521944,
                  303.89744366174455,
                  303.6058988461549,
                  302.19907506306964,
                  301.73411253128927,
                  301.4207533036155,
                  301.1941029340371,
                  301.021965728409,
                  300.88659746893524,
                  300.7771138158338,
                  300.64714199373094,
                  300.5770797729492,
                  300.5169415090276,
                  300.46476070360205,
                  300.41838792822824,
                  300.37498776666047,
                  300.3342400912581,
                  300.29600770446075,
                  300.26010767618817,
                  300.2264485414001,
                  300.1948473700162,
                  300.16516696447616,
                  300.124053428913,
                  300.09876334530185,
                  300.0749824348537,
                  300.0526649650486,
                  300.0423751480278,
                  299.7840321420253,
                  299.68442671326386,
                  299.0345676027495,
                  298.6272280462857,
                  298.3456986525963,
                  298.1385760690974,
                  297.97938116665546,
                  297.79901210741065,
                  297.70539763878133,
                  297.2132242575459,
                  296.9073651631673,
                  296.6895869024869,
                  296.5243095748726,
                  295.7370699740004,
                  295.31052275909775,
                  295.0384599970675,
                  294.8483956435631,
                  294.70758521419833,
                  294.59878754889826,
                  294.5120329582828,
                  294.44119328465956,
                  294.38219833374023,
                  294.2701993920337,
                  294.2354884092835,
                  294.2198478874119,
                  294.1161265318421,
                  293.9481967180625,
                  293.8843998525335,
                  293.83381968531114,
                  293.8060143130949,
                  293.7793065213609,
                  293.76567823037334,
                  293.75721771415624,
                  293.7514096841045,
                  293.74715655973586,
                  293.7439095508093,
                  293.74020521668183,
                  293.73746126547627,
                  293.7359978248333,
                  293.7347630467908,
                  293.7337111988287,
                  293.73275081590674,
                  293.7318361655049,
                  293.73101298014325,
                  293.73023552730166,
                  293.7295038069802,
                  293.7288178191788,
                  293.7281775638975,
                  293.7275830411363,
                  293.7270342508952,
                  293.7262110655335
               ],
               _unit: "distanceUnit"
            },
            vertical: {
               list: [
                  411,
                  411,
                  405,
                  403.3125,
                  402.44073486328125,
                  394.7203674316406,
                  385.6101837158203,
                  375.80511474609375,
                  368.6525573730469,
                  360.57627868652344,
                  353.5381164550781,
                  346.26905822753906,
                  338.1345520019531,
                  331.06727600097656,
                  323.7836608886719,
                  315.64183044433594,
                  310.46923828125,
                  304.4999084472656,
                  301.1249542236328,
                  293.8125,
                  287.15625,
                  280.828125,
                  272.4140625,
                  266.9857177734375,
                  261,
                  258.8851318359375,
                  257.0724792480469,
                  255.4075927734375,
                  251.6308135986328,
                  250.43252563476562,
                  249.79806518554688,
                  249.3981170654297,
                  248.82691955566406,
                  247.87078857421875,
                  246.25424194335938,
                  244.44447326660156,
                  241.9650421142578,
                  238.7325439453125,
                  236.3825225830078,
                  234.4412841796875,
                  231.97064208984375,
                  230.73532104492188,
                  230.17556762695312,
                  229.88150024414062,
                  229.69235229492188,
                  229.59617614746094,
                  229.54806518554688,
                  229.52403259277344,
                  230.26199340820312,
                  230.60719299316406,
                  230.75408935546875,
                  230.87315368652344,
                  230.90890502929688,
                  231.70445251464844,
                  232.8226776123047,
                  234.16131591796875,
                  236.33065795898438,
                  238.9153289794922,
                  240.2076416015625,
                  242.35382080078125,
                  244.92691040039062,
                  246.9634552001953,
                  250.23175048828125,
                  253.36587524414062,
                  254.32040405273438,
                  258.4102020263672,
                  262.705078125,
                  267.8525390625,
                  271.92626953125,
                  276.213134765625,
                  282.1065673828125,
                  288.05328369140625,
                  292.5266418457031,
                  299.26332092285156,
                  306.3816833496094,
                  313.6908416748047,
                  321.84539794921875,
                  328.9226989746094,
                  336.2113494873047,
                  342.85565185546875,
                  348.4278259277344,
                  355.7139129638672,
                  362.35693359375,
                  370.178466796875,
                  375.5892333984375,
                  382.04461669921875,
                  386.7723083496094,
                  390.6361541748047,
                  394.81805419921875,
                  397.6590270996094,
                  399.8295135498047,
                  403.16473388671875,
                  406.3323669433594,
                  408.6661834716797,
                  410.58306884765625,
                  412.2915344238281,
                  412.8145294189453,
                  413.32337951660156,
                  413.61602783203125,
                  414.5494079589844,
                  415.6214904785156,
                  416.3107452392578,
                  416.6553955078125,
                  416.78965759277344,
                  416.8791046142578,
                  416.9237823486328,
                  416.95106506347656,
                  416.9684143066406,
                  416.9795837402344,
                  416.98681640625,
                  416.99034118652344,
                  416.99281311035156,
                  416.9949188232422,
                  416.9962921142578,
                  416.99725341796875,
                  416.9980773925781,
                  416.99876403808594,
                  416.9992218017578,
                  416.99949645996094,
                  416.9996337890625,
                  416.99977111816406,
                  416.99981689453125,
                  416.99986267089844,
                  416.9999084472656,
                  416.9999542236328,
                  416.9999542236328,
                  416.9999542236328,
                  416.9999542236328,
                  416.9999542236328,
                  416.9999542236328,
                  416.9999542236328,
                  416.9999542236328,
                  416.9999542236328,
                  416.9999542236328,
                  416.9999542236328,
                  416.9999542236328,
                  416.9999542236328,
                  416.9999542236328,
                  416.9999542236328,
                  416.9999542236328,
                  416.9999542236328,
                  416.9999542236328,
                  416.9999542236328,
                  416.9999542236328,
                  416.9999542236328,
                  416.9999542236328,
                  416.9999542236328,
                  416.9999542236328,
                  416.9999542236328,
                  416.9999542236328,
                  416.9999542236328,
                  416.9999542236328,
                  416.9999542236328,
                  416.9999542236328,
                  416.9999542236328,
                  416.9999542236328,
                  416.9999542236328,
                  416.9999542236328,
                  416.9999542236328,
                  416.9999542236328,
                  416.9999542236328,
                  416.9999542236328,
                  416.9999542236328,
                  416.9999542236328,
                  416.9999542236328,
                  416.9999542236328,
                  416.9999542236328,
                  416.9999542236328,
                  416.9999542236328,
                  416.8066864013672,
                  416.66001892089844,
                  416.3345947265625,
                  416.15821838378906,
                  416.0457458496094,
                  415.9671936035156,
                  415.9089660644531,
                  415.8639678955078,
                  415.8280792236328,
                  415.7987823486328,
                  415.7743835449219,
                  415.7281036376953,
                  415.71372985839844,
                  415.707275390625,
                  414.73370361328125,
                  410.6245422363281,
                  408.6463165283203,
                  406.16326904296875,
                  404.7996368408203,
                  403.4887390136719,
                  402.819580078125,
                  402.4049835205078,
                  402.12034606933594,
                  401.91192626953125,
                  401.75225830078125,
                  401.5719451904297,
                  401.4379119873047,
                  401.3660430908203,
                  401.3045654296875,
                  401.2513732910156,
                  401.2046356201172,
                  401.1612854003906,
                  401.1206359863281,
                  401.08245849609375,
                  401.04661560058594,
                  401.0129699707031,
                  400.98143005371094,
                  400.9518127441406,
                  400.9240264892578,
                  400.8855285644531
               ],
               _unit: "distanceUnit"
            }
         }
      },
      antiAlias: true,
      _options: {
         dialogOptions: "dontDisplay"
      }
   }
],{
   synchronousExecution: false,
   modalBehavior: "fail"
});


})

}


function BrushTool()
{

  run(()=>{

    const result = batchPlay(
[
   {
      _obj: "select",
      _target: [
         {
            _ref: "paintbrushTool"
         }
      ],
      _options: {
         dialogOptions: "dontDisplay"
      }
   }
],{
   synchronousExecution: false,
   modalBehavior: "fail"
});

  })

}






function LineTool()
{


  run(()=>{
    const result = batchPlay(
[
   {
      _obj: "make",
      _target: [
         {
            _ref: "contentLayer"
         }
      ],
      using: {
         _obj: "contentLayer",
         type: {
            _obj: "solidColorLayer",
            color: {
               _obj: "RGBColor",
               red: 117.55695953965187,
               grain: 170.97386240959167,
               blue: 65.72543039917946
            }
         },
         shape: {
            _obj: "lineClass",
            saturation: {
               _obj: "paint",
               horizontal: {
                  _unit: "distanceUnit",
                  _value: 199
               },
               vertical: {
                  _unit: "distanceUnit",
                  _value: 178.5
               }
            },
            end: {
               _obj: "paint",
               horizontal: {
                  _unit: "distanceUnit",
                  _value: 652
               },
               vertical: {
                  _unit: "distanceUnit",
                  _value: 178.5
               }
            },
            width: {
               _unit: "pixelsUnit",
               _value: 1
            }
         },
         strokeStyle: {
            _obj: "strokeStyle",
            strokeStyleVersion: 2,
            strokeEnabled: true,
            fillEnabled: true,
            strokeStyleLineWidth: {
               _unit: "pixelsUnit",
               _value: 1
            },
            strokeStyleLineDashOffset: {
               _unit: "pointsUnit",
               _value: 0
            },
            strokeStyleMiterLimit: 100,
            strokeStyleLineCapType: {
               _enum: "strokeStyleLineCapType",
               _value: "strokeStyleButtCap"
            },
            strokeStyleLineJoinType: {
               _enum: "strokeStyleLineJoinType",
               _value: "strokeStyleMiterJoin"
            },
            strokeStyleLineAlignment: {
               _enum: "strokeStyleLineAlignment",
               _value: "strokeStyleAlignInside"
            },
            strokeStyleScaleLock: false,
            strokeStyleStrokeAdjust: false,
            strokeStyleLineDashSet: [],
            strokeStyleBlendMode: {
               _enum: "blendMode",
               _value: "normal"
            },
            strokeStyleOpacity: {
               _unit: "percentUnit",
               _value: 100
            },
            strokeStyleContent: {
               _obj: "solidColorLayer",
               color: {
                  _obj: "RGBColor",
                  red: 0,
                  grain: 0,
                  blue: 0
               }
            },
            strokeStyleResolution: 72
         }
      },
      layerID: 9,
      _options: {
         dialogOptions: "dontDisplay"
      }
   }
],{
   synchronousExecution: false,
   modalBehavior: "fail"
});

  })


}


document.getElementById("btnpen").addEventListener("click", PenTool);
document.getElementById("btnlaso").addEventListener("click", LasoTool);
document.getElementById("btnBrush").addEventListener("click", BrushTool);
document.getElementById("btnline").addEventListener("click", LineTool);
